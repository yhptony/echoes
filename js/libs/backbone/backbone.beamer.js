define(["underscore","backbonesrc"],function(){var e=this._,t=this.Backbone;if(!e||!t||!JSON)return;var n={View:{},Model:{},Collection:{},Router:{}},r=function(t,r){return function(i){var s=i.initialize||this.prototype.initialize||function(){};return i.initialize=function(){e.each(n[r],function(t,n){this[n]&&(e.extend(this,new t.extension(this)),t.initialize&&t.initialize.apply(this))},this),s.apply(this,arguments)},t.call(this,i)}},i={View:!1,Model:!1,Collection:!1,Router:!1},s=function(n){this._type=n,t.on("extend:"+n,e.bind(this.register,this))};s.prototype={register:function(e){this.config=e,this.ensureExtend(),this.validate()&&(n[this._type][e.key]=e)},ensureExtend:function(){i[this._type]||(i[this._type]=!0,t[this._type].extend=r(t[this._type].extend,this._type))},validate:function(){return n[this._type][this.config.key]&&console.log("An extension with the same key:",extConfig.key,"is already exsiting or has already been loaded."),!n[this._type][this.config.key]}};var o=["View","Model","Collection","Router"],u=function(e){new s(e)};e.each(o,u)});